---
title: "ETC5521 Assignment 1"
subtitle: "Beach Volleyball Stats"
team: [emu]
author:
  - [Justin Thomas]
  - [Mayunk Bharadwaj]
date: "`r Sys.Date()`"
output: 
  html_document
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r}
library(tidyverse)
library(readr)
```


# Introduction and motivation

[FILL] Give the bigger picture of the data, and inspire the reader to learn more about the problem by reading your analysis. 

# Data description

```{r data-read-in, include=FALSE}

vb_matches <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-19/vb_matches.csv', guess_max = 76000)
```

**Questions we will be looking to answer:**

**Primary Question**

What does a winning beach volleyball team's profile look like for both male and female teams?

**Secondary Questions**

Which countries have the most winning players?
What is the average age of a winning team and how does it compare with a losing team?
What is the average height of a winning team and how does it compare with a losing team?

## Explanation of data being used
This data set provides beach volleyball statistics for men's and women's matches at two major tournaments, the Fédération Internationale de Volleyball (FIVB) Beach Volleyball World Championships and the Association of Volleyball Professionals (AVP) tour. The matches are played with teams of 2. In this data set, tournament information, player information, player performance statistics and match results are recorded. The data provided ranges from September 2000 to August 2019 and it has been collected by the data recorded at the tournaments. 

The original data source created by Adam Vagner had initial data recorded from September 2000 to July 2017, however it has been periodically updated with the most recent update coming in May 2020. This can be found at https://github.com/BigTimeStats/beach-volleyball.

The structure of the data set is:
Rows: 76756
Columns: 65
Data types: Character, Numeric, Data and Difftime  

There are 65 variables in this data set:

  1)"circuit"                 2) "tournament"             3) "country"              
  4) "year"                   5) "date"                   6) "gender"               
  7) "match_num"              8) "w_player1"              9) "w_p1_birthdate"       
 10) "w_p1_age"              11) "w_p1_hgt"              12) "w_p1_country"         
 13) "w_player2"             14) "w_p2_birthdate"        15) "w_p2_age"             
 16) "w_p2_hgt"              17) "w_p2_country"          18) "w_rank"               
 19) "l_player1"             20) "l_p1_birthdate"        21) "l_p1_age"             
 22) "l_p1_hgt"              23) "l_p1_country"          24) "l_player2"            
 25) "l_p2_birthdate"        26) "l_p2_age"              27) "l_p2_hgt"             
 28) "l_p2_country"          29) "l_rank"                30) "score"                
 31) "duration"              32) "bracket"               33) "round"                
 34) "w_p1_tot_attacks"      35) "w_p1_tot_kills"        36) "w_p1_tot_errors"      
 37) "w_p1_tot_hitpct"       38) "w_p1_tot_aces"         39) "w_p1_tot_serve_errors"
 40) "w_p1_tot_blocks"       41) "w_p1_tot_digs"         42) "w_p2_tot_attacks"     
 43) "w_p2_tot_kills"        44) "w_p2_tot_errors"       45) "w_p2_tot_hitpct"      
 46) "w_p2_tot_aces"         47) "w_p2_tot_serve_errors" 48) "w_p2_tot_blocks"      
 49) "w_p2_tot_digs"         50) "l_p1_tot_attacks"      51) "l_p1_tot_kills"       
 52) "l_p1_tot_errors"       53) "l_p1_tot_hitpct"       54) "l_p1_tot_aces"        
 55) "l_p1_tot_serve_errors" 56) "l_p1_tot_blocks"       57) "l_p1_tot_digs"        
 58) "l_p2_tot_attacks"      59) "l_p2_tot_kills"        60) "l_p2_tot_errors"      
 61) "l_p2_tot_hitpct"       62) "l_p2_tot_aces"         63) "l_p2_tot_serve_errors"
 64) "l_p2_tot_blocks"       65) "l_p2_tot_digs"

## Data Cleaning

Our data was already in tidy format, so we did not have much cleaning to do. However in order to conduct our analysis, we have tidied the data set by removing variables that are not pertinent to answer our questions. 

```{r tidy-data, include=FALSE}
vb_matches <- vb_matches %>% select(-duration:-l_p2_tot_digs) %>% select(c(-tournament, -match_num, -w_rank, -l_rank))
```

The methods we have used to tidy our data is as follows:

- We deselected some variables from appearing in the data set and overwrote the original data set with the new tidied data set.

The reason for why we did not include variables such as match duration, or individual player performance statistics was because it did not fit with answering the questions we have laid out. Additionally, majority of the data for these variables were unknown, so it would not have been useful in our analysis.

## Description of variables in data set as organised in tidy form 

Variable       | Description
---------------|------------
circuit	       |Either AVP (USA) or FIVB (International)
country	       |Country where tournament played
year	         |Year of tournament
date	         |Date of match
gender	       |Gender of team
w_player1	     |Winner player 1 Name
w_p1_birthdate |Winner player 1 birth date
w_p1_age       |Winner player 1 age
w_p1_hgt	     |Winner player 1 height in inches
w_p1_country	 |Winner player country
w_player2	     |Winner player 2 name
w_p2_birthdate |Winner player 2 birth date
w_p2_age	     |Winner player 2 age
w_p2_hgt	     |Winner player 2 height in inches
w_p2_country	 |Winner player 2 country
l_player1	     |Losing player 1 name
l_p1_birthdate |Losing player 1 birth date
l_p1_age	     |Losing player 1 age
l_p1_hgt	     |Losing player 1 height in inches
l_p1_country	 |Losing player 1 country
l_player2	     |Losing player 2 name
l_p2_birthdate |Losing player 2 birth date
l_p2_age	     |Losing player 2 age
l_p2_hgt	     |Losing player 2 height in inches
l_p2_country	 |Losing player 2 country
score	         |Match score separated by a dash and matches separated by a comma, eg 21 points to 12 points is 21-12

## Data sources

The original data is sourced from:
Vagner, A. (2020, July 20). *BigTimeStats/beach-volleyball*. Retrieved August 22, 2020, from https://github.com/BigTimeStats/beach-volleyball

To load the data set, we had to use a GitHub repository that had the data set. The name of this repository is "Tidy Tuesday". The data set was sourced from this repository:
Mock, J. (2020, May 19). *rfordatasciene/tidytuesday*. Retrieved August 22, 2020, from 
https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-05-19/readme.md


# Analysis and findings

[FILL] Should include at least one plot or numerical summary for each of your questions, that helps the reader arrive at an answer. You should also write paragraphs describing the methods, summaries and findings. 

*What is the average age of a winning team and how does it compare with a losing team?*

The average age for male winning players 1 and 2 are 29.40 and 29.32 respectively. The average age for male losing players 1 and 2, on the other hand, are 29.08 and 28.95. There is no obvious bias to winning and losing due to age - as the average age for losers and winners is about the same. 

This might tell us something, however, about the average age of participation in professional male vollyeball. If we plot every age of, for instance, male winning player 1 (\@ref(fig:age-2)) and male losing player 2 (\@ref(fig:age-3)) as examples, we see that the most commonly occuring ages are in the late 20s (28-29 year of age). Therefore, it is reasonable to infer that male volleyball players - due to the high levels of participation at those ages -- hit their peak in their late 20s.

Now, let's consider women's volleyball. The average age for female winning players 1 and 2 are 27.98 and 28.29. The average age for female losing players 1 and 2 are 27.52 and 27.73. As was the case with the male game, age does not seem to strongly infuence winning. However, it is interesting to note that their is a slight difference in average age of winning and losing players between the genders. If we take a look at the average age of winning player 2 in figure (\@ref(fig:age-4)), we can see that the average age of winning player 2 is less for females than males. Similarly, if we consider the average age of losing player 1 in figure (\@ref(fig:age-5)) , we can see that the average age is also less for females than it is for males.

```{r age}
#selecting only relevant variables
age <- vb_matches %>%
  select(gender, w_p1_age,w_p2_age,l_p1_age,l_p2_age)

#summary stats for male player ages
age_summary_male <- age %>%
  filter(gender=="M") %>%
  summary()

#summary stats for female player ages
age_summary_female <- age %>%
  filter(gender=="W") %>%
  summary()

```

```{r age-2, fig.cap="Ages of Male Winning Player 1"}

#histogram male winning player 1 ages
age %>%
  filter(gender=="M") %>%
  ggplot() +
  geom_histogram(aes(w_p1_age),binwidth = 1) +
  xlab("Ages") +
  ylab("") +
  ggtitle("Ages of Male Winning Player 1")
```

```{r age-3, fig.cap="Ages of Male Losing Player 2"}
#histogram male losing player 2 ages
age %>%
  filter(gender=="M") %>%
  ggplot() +
  geom_histogram(aes(l_p2_age),binwidth = 1) +
  xlab("Ages") +
  ylab("") +
  ggtitle("Ages of Male Losing Player 2")
```

```{r age-4, fig.cap="Ages of Winning Player 2 by gender"}

#boxplot for age gap between genders for winning player 2
age %>%
  ggplot(aes(w_p2_age)) +
  geom_boxplot() +
  facet_wrap(~gender) +
  coord_flip() +
  theme(
  axis.text.x = element_blank(),
  axis.ticks = element_blank()) +
  xlab("Ages") +
  ggtitle("Ages of Winning Player 2 by gender")
```

```{r age-5, fig.cap="Ages of Losing Player 1 by gender"}

#boxplot for age gap between genders for losing player 1
age %>%
  ggplot(aes(l_p1_age)) +
  geom_boxplot() +
  facet_wrap(~gender) +
  coord_flip() +
  theme(
  axis.text.x = element_blank(),
  axis.ticks = element_blank()) +
  xlab("Ages") +
  ggtitle("Ages of Losing Player 1 by gender")

```


*What is the average height of a winning team and how does it compare with a losing team?*

The average height for female winning players 1 and 2 are 70.91 and 70.85 inches respectively. The average height for female losing players 1 and 2 are 70.62 and 70.72 inches respectively. Althought the average height for the losing players is less than the height of winning players, it is not a huge difference.

The average height for male winning players 1 and 2 are 76.28 and 76.39 inches respectively, compared to the height for losing players 1 and 2 of 75.98 and 76.15. Consider figures \@ref(fig:male-height-diff-boxplot) and \@ref(fig:female-height-diff-boxplot), which display the difference in heights between winning and losing players 1 (fig.\@ref(fig:male-height-diff-boxplot)) and winning and losing player 2 (fig.\@ref(fig:female-height-diff-boxplot)). In both situations, the means in difference in height are pretty evenly centred around 0. so we probably can't say much to the effect of height difference on winning a volleyball game. We can however see that male volleyball participants are generally taller than female volleyball participants although through commonsense we know this phenomenon is not unique to just volleyball.

```{r height-1}

#selecting relevant variables
height <- vb_matches %>%
  select(gender,w_p1_hgt,w_p2_hgt,l_p1_hgt,l_p2_hgt)

#female height summary
height_summary_female <- height %>%
  filter(gender=="W") %>%
  summary()

#male height summary
height_summary_male <- height %>%
  filter(gender=="M") %>%
  summary()
```

```{r height-diff}

#creating two new variables measuting difference in height between winning and losing players
height_diff <- vb_matches %>%
  mutate(diff_hgt_p1=w_p1_hgt-l_p1_hgt,
         diff_hgt_p2=w_p2_hgt-l_p2_hgt)
```

```{r male-height-diff-boxplot, fig.cap="Difference in Heights of Male Player 1"}

#boxplot for difference in height in male player 1s
height_diff %>%
  filter(gender=="M") %>%
  ggplot(aes(diff_hgt_p1)) +
  geom_boxplot() +
  coord_flip() +
  theme(
  axis.text.x = element_blank(),
  axis.ticks = element_blank()) +
  xlab("Difference in Height (inches)") +
  ggtitle("Difference in Height")
```

```{r female-height-diff-boxplot, fig.cap=Difference in Heights of Male Player 2"}

#boxplot for difference in height in male player 2s
height_diff %>%
  filter(gender=="M") %>%
  ggplot(aes(diff_hgt_p2)) +
  geom_boxplot() +
  coord_flip() +
  theme(
  axis.text.x = element_blank(),
  axis.ticks = element_blank()) +
  xlab("Difference in Height (inches)") +
  ggtitle("Difference in Heights of Male Player 2")
```


# References
